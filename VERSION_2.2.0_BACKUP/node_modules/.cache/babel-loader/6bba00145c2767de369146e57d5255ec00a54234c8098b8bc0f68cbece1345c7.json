{"ast":null,"code":"/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n/**\n * @module GraphRequestUtil\n */\nimport { GRAPH_URLS } from \"./Constants\";\nimport { GraphClientError } from \"./GraphClientError\";\n/**\n * To hold list of OData query params\n */\nexport const oDataQueryNames = [\"$select\", \"$expand\", \"$orderby\", \"$filter\", \"$top\", \"$skip\", \"$skipToken\", \"$count\"];\n/**\n * To construct the URL by appending the segments with \"/\"\n * @param {string[]} urlSegments - The array of strings\n * @returns The constructed URL string\n */\nexport const urlJoin = urlSegments => {\n  const removePostSlash = s => s.replace(/\\/+$/, \"\");\n  const removePreSlash = s => s.replace(/^\\/+/, \"\");\n  const joiner = (pre, cur) => [removePostSlash(pre), removePreSlash(cur)].join(\"/\");\n  const parts = Array.prototype.slice.call(urlSegments);\n  return parts.reduce(joiner);\n};\n/**\n * Serializes the content\n * @param {any} content - The content value that needs to be serialized\n * @returns The serialized content\n *\n * Note:\n * This conversion is required due to the following reasons:\n * Body parameter of Request method of isomorphic-fetch only accepts Blob, ArrayBuffer, FormData, TypedArrays string.\n * Node.js platform does not support Blob, FormData. Javascript File object inherits from Blob so it is also not supported in node. Therefore content of type Blob, File, FormData will only come from browsers.\n * Parallel to ArrayBuffer in javascript, node provides Buffer interface. Node's Buffer is able to send the arbitrary binary data to the server successfully for both Browser and Node platform. Whereas sending binary data via ArrayBuffer or TypedArrays was only possible using Browser. To support both Node and Browser, `serializeContent` converts TypedArrays or ArrayBuffer to `Node Buffer`.\n * If the data received is in JSON format, `serializeContent` converts the JSON to string.\n */\nexport const serializeContent = content => {\n  const className = content && content.constructor && content.constructor.name;\n  if (className === \"Buffer\" || className === \"Blob\" || className === \"File\" || className === \"FormData\" || typeof content === \"string\") {\n    return content;\n  }\n  if (className === \"ArrayBuffer\") {\n    content = Buffer.from(content);\n  } else if (className === \"Int8Array\" || className === \"Int16Array\" || className === \"Int32Array\" || className === \"Uint8Array\" || className === \"Uint16Array\" || className === \"Uint32Array\" || className === \"Uint8ClampedArray\" || className === \"Float32Array\" || className === \"Float64Array\" || className === \"DataView\") {\n    content = Buffer.from(content.buffer);\n  } else {\n    try {\n      content = JSON.stringify(content);\n    } catch (error) {\n      throw new Error(\"Unable to stringify the content\");\n    }\n  }\n  return content;\n};\n/**\n * Checks if the url is one of the service root endpoints for Microsoft Graph and Graph Explorer.\n * @param {string} url - The url to be verified\n * @returns {boolean} - Returns true if the url is a Graph URL\n */\nexport const isGraphURL = url => {\n  return isValidEndpoint(url);\n};\n/**\n * Checks if the url is for one of the custom hosts provided during client initialization\n * @param {string} url - The url to be verified\n * @param {Set} customHosts - The url to be verified\n * @returns {boolean} - Returns true if the url is a for a custom host\n */\nexport const isCustomHost = (url, customHosts) => {\n  customHosts.forEach(host => isCustomHostValid(host));\n  return isValidEndpoint(url, customHosts);\n};\n/**\n * Checks if the url is for one of the provided hosts.\n * @param {string} url - The url to be verified\n * @param {Set<string>} allowedHosts - A set of hosts.\n * @returns {boolean} - Returns true is for one of the provided endpoints.\n */\nconst isValidEndpoint = function (url) {\n  let allowedHosts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : GRAPH_URLS;\n  // Valid Graph URL pattern - https://graph.microsoft.com/{version}/{resource}?{query-parameters}\n  // Valid Graph URL example - https://graph.microsoft.com/v1.0/\n  url = url.toLowerCase();\n  if (url.indexOf(\"https://\") !== -1) {\n    url = url.replace(\"https://\", \"\");\n    // Find where the host ends\n    const startofPortNoPos = url.indexOf(\":\");\n    const endOfHostStrPos = url.indexOf(\"/\");\n    let hostName = \"\";\n    if (endOfHostStrPos !== -1) {\n      if (startofPortNoPos !== -1 && startofPortNoPos < endOfHostStrPos) {\n        hostName = url.substring(0, startofPortNoPos);\n        return allowedHosts.has(hostName);\n      }\n      // Parse out the host\n      hostName = url.substring(0, endOfHostStrPos);\n      return allowedHosts.has(hostName);\n    }\n  }\n  return false;\n};\n/**\n * Throws error if the string is not a valid host/hostname and contains other url parts.\n * @param {string} host - The host to be verified\n */\nconst isCustomHostValid = host => {\n  if (host.indexOf(\"/\") !== -1) {\n    throw new GraphClientError(\"Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`\");\n  }\n};","map":{"version":3,"names":["GRAPH_URLS","GraphClientError","oDataQueryNames","urlJoin","urlSegments","removePostSlash","s","replace","removePreSlash","joiner","pre","cur","join","parts","Array","prototype","slice","call","reduce","serializeContent","content","className","constructor","name","Buffer","from","buffer","JSON","stringify","error","Error","isGraphURL","url","isValidEndpoint","isCustomHost","customHosts","forEach","host","isCustomHostValid","allowedHosts","arguments","length","undefined","toLowerCase","indexOf","startofPortNoPos","endOfHostStrPos","hostName","substring","has"],"sources":["/Users/nic/housing-deadlines-app/node_modules/@microsoft/microsoft-graph-client/src/GraphRequestUtil.ts"],"sourcesContent":["/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module GraphRequestUtil\n */\nimport { GRAPH_URLS } from \"./Constants\";\nimport { GraphClientError } from \"./GraphClientError\";\n/**\n * To hold list of OData query params\n */\nexport const oDataQueryNames = [\"$select\", \"$expand\", \"$orderby\", \"$filter\", \"$top\", \"$skip\", \"$skipToken\", \"$count\"];\n\n/**\n * To construct the URL by appending the segments with \"/\"\n * @param {string[]} urlSegments - The array of strings\n * @returns The constructed URL string\n */\nexport const urlJoin = (urlSegments: string[]): string => {\n\tconst removePostSlash = (s) => s.replace(/\\/+$/, \"\");\n\tconst removePreSlash = (s) => s.replace(/^\\/+/, \"\");\n\tconst joiner = (pre, cur) => [removePostSlash(pre), removePreSlash(cur)].join(\"/\");\n\tconst parts = Array.prototype.slice.call(urlSegments);\n\treturn parts.reduce(joiner);\n};\n\n/**\n * Serializes the content\n * @param {any} content - The content value that needs to be serialized\n * @returns The serialized content\n *\n * Note:\n * This conversion is required due to the following reasons:\n * Body parameter of Request method of isomorphic-fetch only accepts Blob, ArrayBuffer, FormData, TypedArrays string.\n * Node.js platform does not support Blob, FormData. Javascript File object inherits from Blob so it is also not supported in node. Therefore content of type Blob, File, FormData will only come from browsers.\n * Parallel to ArrayBuffer in javascript, node provides Buffer interface. Node's Buffer is able to send the arbitrary binary data to the server successfully for both Browser and Node platform. Whereas sending binary data via ArrayBuffer or TypedArrays was only possible using Browser. To support both Node and Browser, `serializeContent` converts TypedArrays or ArrayBuffer to `Node Buffer`.\n * If the data received is in JSON format, `serializeContent` converts the JSON to string.\n */\n\nexport const serializeContent = (content: any): any => {\n\tconst className: string = content && content.constructor && content.constructor.name;\n\tif (className === \"Buffer\" || className === \"Blob\" || className === \"File\" || className === \"FormData\" || typeof content === \"string\") {\n\t\treturn content;\n\t}\n\tif (className === \"ArrayBuffer\") {\n\t\tcontent = Buffer.from(content);\n\t} else if (className === \"Int8Array\" || className === \"Int16Array\" || className === \"Int32Array\" || className === \"Uint8Array\" || className === \"Uint16Array\" || className === \"Uint32Array\" || className === \"Uint8ClampedArray\" || className === \"Float32Array\" || className === \"Float64Array\" || className === \"DataView\") {\n\t\tcontent = Buffer.from(content.buffer);\n\t} else {\n\t\ttry {\n\t\t\tcontent = JSON.stringify(content);\n\t\t} catch (error) {\n\t\t\tthrow new Error(\"Unable to stringify the content\");\n\t\t}\n\t}\n\treturn content;\n};\n\n/**\n * Checks if the url is one of the service root endpoints for Microsoft Graph and Graph Explorer.\n * @param {string} url - The url to be verified\n * @returns {boolean} - Returns true if the url is a Graph URL\n */\nexport const isGraphURL = (url: string): boolean => {\n\treturn isValidEndpoint(url);\n};\n\n/**\n * Checks if the url is for one of the custom hosts provided during client initialization\n * @param {string} url - The url to be verified\n * @param {Set} customHosts - The url to be verified\n * @returns {boolean} - Returns true if the url is a for a custom host\n */\nexport const isCustomHost = (url: string, customHosts: Set<string>): boolean => {\n\tcustomHosts.forEach((host) => isCustomHostValid(host));\n\treturn isValidEndpoint(url, customHosts);\n};\n\n/**\n * Checks if the url is for one of the provided hosts.\n * @param {string} url - The url to be verified\n * @param {Set<string>} allowedHosts - A set of hosts.\n * @returns {boolean} - Returns true is for one of the provided endpoints.\n */\nconst isValidEndpoint = (url: string, allowedHosts: Set<string> = GRAPH_URLS): boolean => {\n\t// Valid Graph URL pattern - https://graph.microsoft.com/{version}/{resource}?{query-parameters}\n\t// Valid Graph URL example - https://graph.microsoft.com/v1.0/\n\turl = url.toLowerCase();\n\n\tif (url.indexOf(\"https://\") !== -1) {\n\t\turl = url.replace(\"https://\", \"\");\n\n\t\t// Find where the host ends\n\t\tconst startofPortNoPos = url.indexOf(\":\");\n\t\tconst endOfHostStrPos = url.indexOf(\"/\");\n\t\tlet hostName = \"\";\n\t\tif (endOfHostStrPos !== -1) {\n\t\t\tif (startofPortNoPos !== -1 && startofPortNoPos < endOfHostStrPos) {\n\t\t\t\thostName = url.substring(0, startofPortNoPos);\n\t\t\t\treturn allowedHosts.has(hostName);\n\t\t\t}\n\t\t\t// Parse out the host\n\t\t\thostName = url.substring(0, endOfHostStrPos);\n\t\t\treturn allowedHosts.has(hostName);\n\t\t}\n\t}\n\n\treturn false;\n};\n\n/**\n * Throws error if the string is not a valid host/hostname and contains other url parts.\n * @param {string} host - The host to be verified\n */\nconst isCustomHostValid = (host: string) => {\n\tif (host.indexOf(\"/\") !== -1) {\n\t\tthrow new GraphClientError(\"Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`\");\n\t}\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}